Oski (Stealc) Malware Campaign Analysis

Platform: CyberDefenders
Category: Malware Analysis | SOC Investigation
Level: SOC Analyst (Junior‚ÄìIntermediate)

üìå Overview

This lab focuses on the analysis of a malicious campaign involving a file associated with the Stealc (Oski) malware family.
The investigation begins with a suspicious email delivering a seemingly urgent attachment, which later triggers a security alert due to a malicious download.

The objective of this analysis is not tool memorization, but understanding:

How malware behaves post-infection

How SOC analysts validate alerts

How to extract intelligence and map attacker behavior

Tools used include Any.Run, VirusTotal, and static/dynamic analysis techniques.

üéØ Investigation Goals

Identify malware family and creation timeline

Extract Command-and-Control (C2) infrastructure

Analyze post-infection behavior

Identify credential theft techniques

Map behavior to MITRE ATT&CK

Understand evasion and self-deletion mechanisms

üõ† Tools & Resources Used

Any.Run Sandbox

VirusTotal

MITRE ATT&CK Framework

Windows process & file activity analysis

üîç Analysis & Findings
Q1: Malware Creation Time

Why it matters:
Understanding compile time helps determine whether a threat is new, reused, or part of a known campaign.

Finding:

Creation Time: September 28, 2022 ‚Äì 17:40:46 UTC

This suggests the malware is not newly created but still actively used in campaigns, indicating tool reuse by threat actors.

Q2: Command-and-Control (C2) Server

Why it matters:
C2 infrastructure allows attackers to control infected systems and exfiltrate data.

Finding:

C2 IP Address: 171.22.28.221

Observed in:

Memory artifacts

Network traffic

URLs ending in .php and .exe

Defensive Action:

Block and monitor outbound traffic to this IP

Use as an IOC for threat hunting

Q3: First Library Loaded Post-Infection

Why it matters:
Initial library loading often reveals the malware‚Äôs primary objective.

Finding:

First DLL Requested: sqlite3.dll

Insight:
SQLite is commonly used to access browser databases, indicating credential harvesting intent.

Q4: RC4 Encryption Key

Why it matters:
Malware often encrypts strings to evade detection. Extracting keys helps analysts decrypt configs and understand behavior.

Finding:

RC4 Key:

5329514621441247975720749009


Used to decrypt Base64-encoded strings related to:

Configuration

C2 communication

Execution logic

Q5: MITRE ATT&CK Technique Used for Password Theft

Finding:

Technique ID: T1555

Name: Credentials from Password Stores

Explanation:
The malware targets browser-stored credentials, enabling attackers to gain unauthorized access to user accounts.

Q6: File Deletion Targets

Why it matters:
File cleanup is a common evasion technique to reduce forensic evidence.

Findings:
The malware deletes files from:

C:\Users\admin\AppData\Local\Temp\VPN.exe
C:\ProgramData\


Using command-line deletion via cmd.exe, including removal of associated .dll files.

Q7: Self-Deletion Timing

Why it matters:
Self-deletion reduces detection and complicates incident response.

Finding:

Self-deletion delay: 5 seconds after data exfiltration

This ensures the malware completes its mission before erasing itself.

üß† Key Takeaways (SOC Analyst Perspective)

Most malware focuses on credentials, not destruction

Context (process behavior, timing, file access) matters more than alerts alone

Self-deletion is a strong indicator of stealth-focused malware

Mapping findings to MITRE ATT&CK improves detection and reporting quality

üõ° Defensive Recommendations

Monitor outbound connections to unknown IPs

Restrict credential storage in browsers

Enable command-line logging

Improve email attachment filtering

Use EDR rules for suspicious DLL loading and rapid self-deletion

üìö Skills Demonstrated

Malware behavioral analysis

C2 identification and IOC extraction

MITRE ATT&CK mapping

Sandbox investigation

SOC-style documentation

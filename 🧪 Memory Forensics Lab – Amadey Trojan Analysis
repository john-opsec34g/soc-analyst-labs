ğŸ§ª Memory Forensics Lab â€“ Amadey Trojan Analysis
ğŸ“Œ Overview

This lab documents a memory forensics investigation performed on a compromised Windows endpoint.
The goal was to identify malicious activity, determine persistence mechanisms, and understand attacker behavior using memory artifacts rather than relying solely on alerts.

ğŸ¯ Objectives

Analyze a Windows memory image for suspicious processes

Identify malware execution techniques

Detect command-and-control (C2) activity

Understand persistence mechanisms

Practice analyst-level reasoning, not just tool usage

ğŸ–¥ï¸ Lab Environment

Operating System: Windows 7 x64

Artifact Provided: Memory dump (.raw)

Analysis Tool: Volatility 3

Analysis Type: Post-compromise memory investigation

ğŸš¨ Incident Context

An endpoint generated an after-hours EDR alert indicating suspicious network activity.
Initial inspection did not reveal obvious malware on disk, prompting a memory-based investigation.

ğŸ” Investigation Process
1ï¸âƒ£ Process Enumeration

Command used:

vol -f memory.raw windows.pstree


Findings:

Identified a suspicious process named lssass.exe

The legitimate Windows process should be lsass.exe

Executed from a Temp directory, not System32

Parent-child relationship appeared abnormal

ğŸ“Œ Red Flag: Malware often mimics legitimate process names with slight spelling changes.

2ï¸âƒ£ Command-Line Analysis

Command used:

vol -f memory.raw windows.cmdline


Findings:

lssass.exe spawned rundll32.exe

DLLs were executed directly from non-standard directories

ğŸ“Œ Insight: Abuse of rundll32.exe is a common living-off-the-land technique.

3ï¸âƒ£ Network Connections

Command used:

vol -f memory.raw windows.netscan


Findings:

Outbound HTTP connections to an external IP address

Communication occurred shortly after process execution

No corresponding legitimate application activity

ğŸ“Œ Conclusion: Likely Command-and-Control (C2) traffic.

4ï¸âƒ£ Malware Payload Analysis

Memory artifacts revealed multiple malicious DLL modules:

Module Name	Function
cred64.dll	Credential theft
clip64.dll	Clipboard monitoring

These modules indicate data exfiltration and surveillance behavior.

5ï¸âƒ£ Persistence Mechanism

Command used:

vol -f memory.raw windows.scheduledtasks


Findings:

Malware created a Scheduled Task for persistence

Ensured execution after reboot

Task name designed to look legitimate

ğŸ“Œ Persistence via scheduled tasks is common in modern malware.

ğŸ§¬ Malware Identification

Based on behavioral indicators and module structure, the malware was identified as:

Amadey Trojan Stealer (APT-C-36)

Characteristics:

Modular payload delivery

Credential harvesting

Clipboard monitoring

C2 communication via HTTP

Masquerading as legitimate Windows processes

ğŸ› ï¸ Tools Used

Volatility 3

Windows memory artifact analysis

Process tree correlation

Network artifact inspection

ğŸ§  Key Takeaways

Malware does not always appear malicious at first glance

Small inconsistencies (process names, paths) matter

Memory forensics reveals threats invisible to disk analysis

Understanding behavior is more important than memorizing tools

 DanaBot Malware Network Forensics Investigation

## Overview

This investigation documents a real-world style network forensics analysis of a DanaBot malware infection. The objective was to analyze network traffic, identify the initial access vector, extract malicious artifacts, and trace the execution flow used by the attacker to compromise a host and exfiltrate data.

The analysis was conducted from a defender’s perspective, focusing on how malicious activity appears at the network level and how those signals can be validated using packet analysis and threat intelligence.


 Investigation Scope

Incident Type:** Malware infection (DanaBot)
Data Source:** PCAP file
Tools Used:** Wireshark, Linux CLI utilities, threat intelligence platforms
Focus Areas:** Initial access, payload delivery, execution chain, malware identification


 Initial Access Analysis

 Attacker Infrastructure

Analysis of DNS traffic revealed a suspicious request to the domain:


portfolio.serveirc.com


The DNS response resolved to the IP address:


62.173.142.148


Threat intelligence lookups confirmed this domain and IP as malicious, strongly indicating attacker-controlled infrastructure used during the initial compromise.



 Malicious File Identification

 Suspicious HTTP Payload

Using **Wireshark → Export Objects → HTTP**, several downloaded objects were reviewed. One file immediately stood out:


login.php


Although named as a PHP file, its **Content-Type** was set to:


application/octet-stream


This MIME type is often abused to deliver obfuscated or binary payloads while avoiding signature-based detection.

 File Inspection

Running the Linux `file` command revealed that `login.php` was actually:

 Obfuscated JavaScript
 Large single-line structure
 No line terminators

These characteristics are commonly associated with malicious scripts designed to evade analysis.



 JavaScript Deobfuscation & Behavior

After deobfuscation, the JavaScript revealed the following behavior:

Abuse of **ActiveX objects**
Download of a secondary payload from an external domain
Execution of the payload using built-in Windows utilities
Self-deletion after execution (anti-forensic technique)

The script downloaded a second-stage payload named:


resources.dll


Execution was performed via:


rundll32.exe




 Execution Chain

 Process Used

The malicious JavaScript was executed by:


WScript.exe


This leverages Windows Script Host (WSH), a legitimate Windows component commonly abused by malware to execute scripts without dropping traditional executables.

 Second-Stage Payload

File Name:** resources.dll
File Type:** Dynamic Link Library (.dll)

This confirms a multi-stage malware delivery mechanism typical of DanaBot campaigns.



 Hash-Based Identification

 Initial Access File (JavaScript)

SHA-256:


847b4ad90b1daba2d9117a8e05776f3f902dda593fb1252289538acf476c4268


 Second-Stage Payload (DLL)

MD5:


e758e07113016aca55d9eda2b0ffeebe


These hashes serve as unique fingerprints that can be used for malware tracking, detection rule creation, and threat intelligence correlation.



 Key Takeaways

* Legitimate Windows utilities (**WScript.exe**, **rundll32.exe**) are frequently abused by malware to evade detection
* Misleading file extensions and generic MIME types are strong indicators of malicious delivery
* PCAP analysis alone can reveal the full infection chain when properly correlated
* Hashing and threat intelligence validation remain critical in malware investigations



 Skills Demonstrated

* Network traffic analysis (PCAP)
* HTTP object extraction
* Malware staging analysis
* JavaScript deobfuscation
* Hash-based malware identification
* Defender-focused investigation methodology



 Disclaimer

This investigation was conducted in a controlled environment for educational and defensive research purposes only.
